<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>MyProject1: /home/stepsei/workspace/bind9/lib/isc/include/isc/fsaccess.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MyProject1
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">--</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_8f8d5a2a8fb3d53bd9c29794bc65232d.html">isc</a></li><li class="navelem"><a class="el" href="dir_280f2bbac39866abe61ba42fd94618f9.html">include</a></li><li class="navelem"><a class="el" href="dir_c2629041933f55ea008057abdba90943.html">isc</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">fsaccess.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The ISC filesystem access module encapsulates the setting of file and directory access permissions into one API that is meant to be portable to multiple operating systems.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="isc_2include_2isc_2lang_8h_source.html">isc/lang.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="lib_2isc_2include_2isc_2types_8h_source.html">isc/types.h</a>&gt;</code><br />
</div>
<p><a href="fsaccess_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:af5ffd43b1702a0d661e0d3ccc541961b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="af5ffd43b1702a0d661e0d3ccc541961b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ISC_FSACCESS_OWNER</b>&#160;&#160;&#160;0x1 /*%&lt; User account. */</td></tr>
<tr class="separator:af5ffd43b1702a0d661e0d3ccc541961b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed4f90e72c4febdb2353766786fa90dd"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aed4f90e72c4febdb2353766786fa90dd"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ISC_FSACCESS_GROUP</b>&#160;&#160;&#160;0x2 /*%&lt; Primary group owner. */</td></tr>
<tr class="separator:aed4f90e72c4febdb2353766786fa90dd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d9ba9ea8b2db299215fe45a3fce662a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3d9ba9ea8b2db299215fe45a3fce662a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ISC_FSACCESS_OTHER</b>&#160;&#160;&#160;0x4 /*%&lt; Not the owner or the group owner. */</td></tr>
<tr class="separator:a3d9ba9ea8b2db299215fe45a3fce662a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8b4a008a9ee82785aa922abcab33854"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ab8b4a008a9ee82785aa922abcab33854"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ISC_FSACCESS_WORLD</b>&#160;&#160;&#160;0x7 /*%&lt; User, Group, Other. */</td></tr>
<tr class="separator:ab8b4a008a9ee82785aa922abcab33854"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee494951216fefe49f129f4b4ac71082"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aee494951216fefe49f129f4b4ac71082"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ISC_FSACCESS_READ</b>&#160;&#160;&#160;0x00000001 /*%&lt; File only. */</td></tr>
<tr class="separator:aee494951216fefe49f129f4b4ac71082"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b08cb8315ec644c6e2fad1578d2b937"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a9b08cb8315ec644c6e2fad1578d2b937"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ISC_FSACCESS_WRITE</b>&#160;&#160;&#160;0x00000002 /*%&lt; File only. */</td></tr>
<tr class="separator:a9b08cb8315ec644c6e2fad1578d2b937"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa72f5245285a117def9bc4c76195177c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa72f5245285a117def9bc4c76195177c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ISC_FSACCESS_EXECUTE</b>&#160;&#160;&#160;0x00000004 /*%&lt; File only. */</td></tr>
<tr class="separator:aa72f5245285a117def9bc4c76195177c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17ccc559424e2b39de80341510f1735b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a17ccc559424e2b39de80341510f1735b"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ISC_FSACCESS_CREATECHILD</b>&#160;&#160;&#160;0x00000008 /*%&lt; Dir only. */</td></tr>
<tr class="separator:a17ccc559424e2b39de80341510f1735b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a33c9f53df79aebd8f19f202ca7659193"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a33c9f53df79aebd8f19f202ca7659193"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ISC_FSACCESS_DELETECHILD</b>&#160;&#160;&#160;0x00000010 /*%&lt; Dir only. */</td></tr>
<tr class="separator:a33c9f53df79aebd8f19f202ca7659193"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7cb7fb948da2a1258b54b5ec2f17cb2"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa7cb7fb948da2a1258b54b5ec2f17cb2"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ISC_FSACCESS_LISTDIRECTORY</b>&#160;&#160;&#160;0x00000020 /*%&lt; Dir only. */</td></tr>
<tr class="separator:aa7cb7fb948da2a1258b54b5ec2f17cb2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d765d44cfb96540518a1f8379b2f625"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8d765d44cfb96540518a1f8379b2f625"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ISC_FSACCESS_ACCESSCHILD</b>&#160;&#160;&#160;0x00000040 /*%&lt; Dir only. */</td></tr>
<tr class="separator:a8d765d44cfb96540518a1f8379b2f625"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3c3ee1d5829842ad24627bca820e505"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae3c3ee1d5829842ad24627bca820e505"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ISC__FSACCESS_PERMISSIONBITS</b>&#160;&#160;&#160;10</td></tr>
<tr class="separator:ae3c3ee1d5829842ad24627bca820e505"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a341fc3fbd35eb17b3e68349d3f4a3e2c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a341fc3fbd35eb17b3e68349d3f4a3e2c"></a>
ISC_LANG_BEGINDECLS void&#160;</td><td class="memItemRight" valign="bottom"><b>isc_fsaccess_add</b> (int trustee, int permission, isc_fsaccess_t *access)</td></tr>
<tr class="separator:a341fc3fbd35eb17b3e68349d3f4a3e2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c989e6378d843927cb99107fcfaa9ec"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a1c989e6378d843927cb99107fcfaa9ec"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>isc_fsaccess_remove</b> (int trustee, int permission, isc_fsaccess_t *access)</td></tr>
<tr class="separator:a1c989e6378d843927cb99107fcfaa9ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa73627a9c8dd8652b377ff8b26e5f368"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa73627a9c8dd8652b377ff8b26e5f368"></a>
isc_result_t&#160;</td><td class="memItemRight" valign="bottom"><b>isc_fsaccess_set</b> (const char *path, isc_fsaccess_t access)</td></tr>
<tr class="separator:aa73627a9c8dd8652b377ff8b26e5f368"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The ISC filesystem access module encapsulates the setting of file and directory access permissions into one API that is meant to be portable to multiple operating systems. </p>
<p>The two primary operating system flavors that are initially accommodated are POSIX and Windows NT 4.0 and later. The Windows NT access model is considerable more flexible than POSIX's model (as much as I am loathe to admit it), and so the ISC API has a higher degree of complexity than would be needed to simply address POSIX's needs.</p>
<p>The full breadth of NT's flexibility is not available either, for the present time. Much of it is to provide compatibility with what Unix programmers are expecting. This is also due to not yet really needing all of the functionality of an NT system (or, for that matter, a POSIX system) in BIND9, and so resolving how to handle the various incompatibilities has been a purely theoretical exercise with no operational experience to indicate how flawed the thinking may be.</p>
<p>Some of the more notable dumbing down of NT for this API includes:</p>
<ul>
<li>Each of FILE_READ_DATA and FILE_READ_EA are set with #ISC_FSACCESS_READ.</li>
</ul>
<ul>
<li>All of FILE_WRITE_DATA, FILE_WRITE_EA and FILE_APPEND_DATA are set with #ISC_FSACCESS_WRITE. FILE_WRITE_ATTRIBUTES is not set so as to be consistent with Unix, where only the owner of the file or the superuser can change the attributes/mode of a file.</li>
</ul>
<ul>
<li>Both of FILE_ADD_FILE and FILE_ADD_SUBDIRECTORY are set with #ISC_FSACCESS_CREATECHILD. This is similar to setting the WRITE permission on a Unix directory.</li>
</ul>
<ul>
<li>SYNCHRONIZE is always set for files and directories, unless someone can give me a reason why this is a bad idea.</li>
</ul>
<ul>
<li>READ_CONTROL and FILE_READ_ATTRIBUTES are always set; this is consistent with Unix, where any file or directory can be stat()'d unless the directory path disallows complete access somewhere along the way.</li>
</ul>
<ul>
<li>WRITE_DAC is only set for the owner. This too is consistent with Unix, and is tighter security than allowing anyone else to be able to set permissions.</li>
</ul>
<ul>
<li>DELETE is only set for the owner. On Unix the ability to delete a file is controlled by the directory permissions, but it isn't currently clear to me what happens on NT if the directory has FILE_DELETE_CHILD set but a file within it does not have DELETE set. Always setting DELETE on the file/directory for the owner gives maximum flexibility to the owner without exposing the file to deletion by others.</li>
</ul>
<ul>
<li>WRITE_OWNER is never set. This too is consistent with Unix, and is also tighter security than allowing anyone to change the ownership of the file apart from the superu..ahem, Administrator.</li>
</ul>
<ul>
<li>Inheritance is set to NO_INHERITANCE.</li>
</ul>
<p>Unix's dumbing down includes:</p>
<ul>
<li>The sticky bit cannot be set.</li>
</ul>
<ul>
<li>setuid and setgid cannot be set.</li>
</ul>
<ul>
<li>Only regular files and directories can be set.</li>
</ul>
<p>The rest of this comment discusses a few of the incompatibilities between the two systems that need more thought if this API is to be extended to accommodate them.</p>
<p>The Windows standard access right "DELETE" doesn't have a direct equivalent in the Unix world, so it isn't clear what should be done with it.</p>
<p>The Unix sticky bit is not supported. While NT does have a concept of allowing users to create files in a directory but not delete or rename them, it does not have a concept of allowing them to be deleted if they are owned by the user trying to delete/rename. While it is probable that something could be cobbled together in NT 5 with inheritance, it can't really be done in NT 4 as a single property that you could set on a directory. You'd need to coordinate something with file creation so that every file created had DELETE set for the owner but noone else.</p>
<p>On Unix systems, setting #ISC_FSACCESS_LISTDIRECTORY sets READ. ... setting either #ISC_FSACCESS_CREATECHILD or #ISC_FSACCESS_DELETECHILD sets WRITE. ... setting #ISC_FSACCESS_ACCESSCHILD sets EXECUTE.</p>
<p>On NT systems, setting #ISC_FSACCESS_LISTDIRECTORY sets FILE_LIST_DIRECTORY. ... setting #ISC_FSACCESS_CREATECHILD sets FILE_CREATE_CHILD independently. ... setting #ISC_FSACCESS_DELETECHILD sets FILE_DELETE_CHILD independently. ... setting #ISC_FSACCESS_ACCESSCHILD sets FILE_TRAVERSE.</p>
<p>Unresolved: XXXDCL </p><ul>
<li>What NT access right controls the ability to rename a file? </li>
<li>How does DELETE work? If a directory has FILE_DELETE_CHILD but a file or directory within it does not have DELETE, is that file or directory deletable? </li>
<li>To implement isc_fsaccess_get(), mapping an existing Unix permission mode_t back to an isc_fsaccess_t is pretty trivial; however, mapping an NT DACL could be impossible to do in a responsible way. </li>
<li>Similarly, trying to implement the functionality of being able to say "add group writability to whatever permissions already exist" could be tricky on NT because of the order-of-entry issue combined with possibly having one or more matching ACEs already explicitly granting or denying access. Because this functionality is not yet needed by the ISC, no code has been written to try to solve this problem. </li>
</ul>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
