<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>MyProject1: /home/stepsei/workspace/bind9/lib/lwres/gethost.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MyProject1
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">--</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a1b4463e4b2f6ff4aff4dd4221cff45f.html">lwres</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">gethost.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;config.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;lwres/net.h&gt;</code><br />
<code>#include &lt;lwres/netdb.h&gt;</code><br />
<code>#include &quot;<a class="el" href="assert__p_8h_source.html">assert_p.h</a>&quot;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a34899762ef8ceded12f358011b3a1447"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gethost_8c.html#a34899762ef8ceded12f358011b3a1447">LWRES_ALIGNBYTES</a>&#160;&#160;&#160;(sizeof(char *) - 1)</td></tr>
<tr class="separator:a34899762ef8ceded12f358011b3a1447"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a261c9154c6df9cd450c10f72cd6c62f0"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a261c9154c6df9cd450c10f72cd6c62f0"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>LWRES_ALIGN</b>(p)&#160;&#160;&#160;(((uintptr_t)(p) + <a class="el" href="gethost_8c.html#a34899762ef8ceded12f358011b3a1447">LWRES_ALIGNBYTES</a>) &amp;~ <a class="el" href="gethost_8c.html#a34899762ef8ceded12f358011b3a1447">LWRES_ALIGNBYTES</a>)</td></tr>
<tr class="separator:a261c9154c6df9cd450c10f72cd6c62f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac376011ecea4880caf8a93c1ebbb0ef8"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ac376011ecea4880caf8a93c1ebbb0ef8"></a>
struct hostent *&#160;</td><td class="memItemRight" valign="bottom"><b>lwres_gethostbyname</b> (const char *name)</td></tr>
<tr class="separator:ac376011ecea4880caf8a93c1ebbb0ef8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5a7342d15ce0327028a1c03c315f580"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aa5a7342d15ce0327028a1c03c315f580"></a>
struct hostent *&#160;</td><td class="memItemRight" valign="bottom"><b>lwres_gethostbyname2</b> (const char *name, int af)</td></tr>
<tr class="separator:aa5a7342d15ce0327028a1c03c315f580"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a79fa2184233a1e40ec7acd5103128aaf"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a79fa2184233a1e40ec7acd5103128aaf"></a>
struct hostent *&#160;</td><td class="memItemRight" valign="bottom"><b>lwres_gethostbyaddr</b> (const char *<a class="el" href="structaddr.html">addr</a>, int len, int type)</td></tr>
<tr class="separator:a79fa2184233a1e40ec7acd5103128aaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a010eb5de9cbd6deadacc997f121945cb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a010eb5de9cbd6deadacc997f121945cb"></a>
struct hostent *&#160;</td><td class="memItemRight" valign="bottom"><b>lwres_gethostent</b> (void)</td></tr>
<tr class="separator:a010eb5de9cbd6deadacc997f121945cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc56acfa40f5ec88321a04dc189010f6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="afc56acfa40f5ec88321a04dc189010f6"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>lwres_sethostent</b> (int stayopen)</td></tr>
<tr class="separator:afc56acfa40f5ec88321a04dc189010f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a5996cb5437c5a2f97da7f29b0af345"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a0a5996cb5437c5a2f97da7f29b0af345"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>lwres_endhostent</b> (void)</td></tr>
<tr class="separator:a0a5996cb5437c5a2f97da7f29b0af345"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c78751fa68ad4c109b8494e6a54fcab"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7c78751fa68ad4c109b8494e6a54fcab"></a>
struct hostent *&#160;</td><td class="memItemRight" valign="bottom"><b>lwres_gethostbyname_r</b> (const char *name, struct hostent *resbuf, char *buf, int buflen, int *error)</td></tr>
<tr class="separator:a7c78751fa68ad4c109b8494e6a54fcab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b3fbb46fdff8b02ac2071f8c548a5e7"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a5b3fbb46fdff8b02ac2071f8c548a5e7"></a>
struct hostent *&#160;</td><td class="memItemRight" valign="bottom"><b>lwres_gethostbyaddr_r</b> (const char *<a class="el" href="structaddr.html">addr</a>, int len, int type, struct hostent *resbuf, char *buf, int buflen, int *error)</td></tr>
<tr class="separator:a5b3fbb46fdff8b02ac2071f8c548a5e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3fc16ffcd00608fb6f14e1b3740fdac5"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3fc16ffcd00608fb6f14e1b3740fdac5"></a>
struct hostent *&#160;</td><td class="memItemRight" valign="bottom"><b>lwres_gethostent_r</b> (struct hostent *resbuf, char *buf, int buflen, int *error)</td></tr>
<tr class="separator:a3fc16ffcd00608fb6f14e1b3740fdac5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83f96e544c86f8b40d10bf17d5268adc"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a83f96e544c86f8b40d10bf17d5268adc"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>lwres_sethostent_r</b> (int stayopen)</td></tr>
<tr class="separator:a83f96e544c86f8b40d10bf17d5268adc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a54c3f5b9d96d6bf3fb546ccf9195fb80"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a54c3f5b9d96d6bf3fb546ccf9195fb80"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>lwres_endhostent_r</b> (void)</td></tr>
<tr class="separator:a54c3f5b9d96d6bf3fb546ccf9195fb80"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a34899762ef8ceded12f358011b3a1447"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LWRES_ALIGNBYTES&#160;&#160;&#160;(sizeof(char *) - 1)</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>These functions provide hostname-to-address and address-to-hostname lookups by means of the lightweight resolver. They are similar to the standard gethostent(3) functions provided by most operating systems. They use a struct hostent which is usually defined in &lt;namedb.h&gt;.</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;struct  hostent {</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        char    *h_name;        // official name of host</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;       char    **h_aliases;    // alias list</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        int     h_addrtype;     // host address type</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        int     h_length;       // length of address</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        char    **h_addr_list;  // list of addresses from name server</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;};</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;#define h_addr  h_addr_list[0]  // address, for backward compatibility</div></div><!-- fragment --><p>The members of this structure are:</p>
<ul>
<li>h_name: The official (canonical) name of the host.</li>
</ul>
<ul>
<li>h_aliases: A NULL-terminated array of alternate names (nicknames) for the host.</li>
</ul>
<ul>
<li>h_addrtype: The type of address being returned &ndash; PF_INET or PF_INET6.</li>
</ul>
<ul>
<li>h_length: The length of the address in bytes.</li>
</ul>
<ul>
<li>h_addr_list: A NULL terminated array of network addresses for the host. Host addresses are returned in network byte order.</li>
</ul>
<p>For backward compatibility with very old software, h_addr is the first address in h_addr_list.</p>
<p>lwres_gethostent(), lwres_sethostent(), lwres_endhostent(), lwres_gethostent_r(), lwres_sethostent_r() and lwres_endhostent_r() provide iteration over the known host entries on systems that provide such functionality through facilities like /etc/hosts or NIS. The lightweight resolver does not currently implement these functions; it only provides them as stub functions that always return failure.</p>
<p>lwres_gethostbyname() and lwres_gethostbyname2() look up the hostname name. lwres_gethostbyname() always looks for an IPv4 address while lwres_gethostbyname2() looks for an address of protocol family af: either PF_INET or PF_INET6 &ndash; IPv4 or IPV6 addresses respectively. Successful calls of the functions return a struct hostent for the name that was looked up. NULL is returned if the lookups by lwres_gethostbyname() or lwres_gethostbyname2() fail.</p>
<p>Reverse lookups of addresses are performed by lwres_gethostbyaddr(). addr is an address of length len bytes and protocol family type &ndash; PF_INET or PF_INET6. lwres_gethostbyname_r() is a thread-safe function for forward lookups. If an error occurs, an error code is returned in *error. resbuf is a pointer to a struct hostent which is initialised by a successful call to lwres_gethostbyname_r() . buf is a buffer of length len bytes which is used to store the h_name, h_aliases, and h_addr_list elements of the struct hostent returned in resbuf. Successful calls to lwres_gethostbyname_r() return resbuf, which is a pointer to the struct hostent it created.</p>
<p>lwres_gethostbyaddr_r() is a thread-safe function that performs a reverse lookup of address addr which is len bytes long and is of protocol family type &ndash; PF_INET or PF_INET6. If an error occurs, the error code is returned in *error. The other function parameters are identical to those in lwres_gethostbyname_r(). resbuf is a pointer to a struct hostent which is initialised by a successful call to lwres_gethostbyaddr_r(). buf is a buffer of length len bytes which is used to store the h_name, h_aliases, and h_addr_list elements of the struct hostent returned in resbuf. Successful calls to lwres_gethostbyaddr_r() return resbuf, which is a pointer to the struct hostent it created.</p>
<h1><a class="anchor" id="gethost_return"></a>
Return Values</h1>
<p>The functions lwres_gethostbyname(), lwres_gethostbyname2(), lwres_gethostbyaddr(), and lwres_gethostent() return NULL to indicate an error. In this case the global variable lwres_h_errno will contain one of the following error codes defined in <a class="el" href="">&lt;lwres/netdb.h&gt;:</a></p>
<ul>
<li>#HOST_NOT_FOUND: The host or address was not found.</li>
</ul>
<ul>
<li>#TRY_AGAIN: A recoverable error occurred, e.g., a timeout. Retrying the lookup may succeed.</li>
</ul>
<ul>
<li>#NO_RECOVERY: A non-recoverable error occurred.</li>
</ul>
<ul>
<li>#NO_DATA: The name exists, but has no address information associated with it (or vice versa in the case of a reverse lookup). The code NO_ADDRESS is accepted as a synonym for NO_DATA for backwards compatibility.</li>
</ul>
<p><a class="el" href="herror_8c.html#a5f8b639cb113b671ecb90ff1a06cee7d">lwres_hstrerror()</a> translates these error codes to suitable error messages.</p>
<p>lwres_gethostent() and lwres_gethostent_r() always return NULL.</p>
<p>Successful calls to lwres_gethostbyname_r() and lwres_gethostbyaddr_r() return resbuf, a pointer to the struct hostent that was initialised by these functions. They return NULL if the lookups fail or if buf was too small to hold the list of addresses and names referenced by the h_name, h_aliases, and h_addr_list elements of the struct hostent. If buf was too small, both lwres_gethostbyname_r() and lwres_gethostbyaddr_r() set the global variable errno to ERANGE.</p>
<h1><a class="anchor" id="gethost_see"></a>
See Also</h1>
<p>gethostent(), <a class="el" href="getipnode_8c.html">getipnode</a>, <a class="el" href="herror_8c.html#a5f8b639cb113b671ecb90ff1a06cee7d">lwres_hstrerror()</a></p>
<h1><a class="anchor" id="gethost_bugs"></a>
Bugs</h1>
<p>lwres_gethostbyname(), lwres_gethostbyname2(), lwres_gethostbyaddr() and lwres_endhostent() are not thread safe; they return pointers to static data and provide error codes through a global variable. Thread-safe versions for name and address lookup are provided by lwres_gethostbyname_r(), and lwres_gethostbyaddr_r() respectively.</p>
<p>The resolver daemon does not currently support any non-DNS name services such as /etc/hosts or NIS, consequently the above functions don't, either. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
