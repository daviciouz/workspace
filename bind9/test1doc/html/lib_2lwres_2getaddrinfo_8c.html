<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>MyProject1: /home/stepsei/workspace/bind9/lib/lwres/getaddrinfo.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">MyProject1
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">--</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_97aefd0d527b934f1d99a682da8fe6a9.html">lib</a></li><li class="navelem"><a class="el" href="dir_a1b4463e4b2f6ff4aff4dd4221cff45f.html">lwres</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">getaddrinfo.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;config.h&gt;</code><br />
<code>#include &lt;errno.h&gt;</code><br />
<code>#include &lt;string.h&gt;</code><br />
<code>#include &lt;<a class="el" href="lwres_8h_source.html">lwres/lwres.h</a>&gt;</code><br />
<code>#include &lt;lwres/net.h&gt;</code><br />
<code>#include &lt;lwres/netdb.h&gt;</code><br />
<code>#include &lt;<a class="el" href="lwres_2include_2lwres_2stdlib_8h_source.html">lwres/stdlib.h</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="lwres_2include_2lwres_2string_8h_source.html">lwres/string.h</a>&gt;</code><br />
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a65f4c637d8673d733619c36e5218c731"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib_2lwres_2getaddrinfo_8c.html#a65f4c637d8673d733619c36e5218c731">SA</a>(<a class="el" href="structaddr.html">addr</a>)&#160;&#160;&#160;((struct sockaddr *)(<a class="el" href="structaddr.html">addr</a>))</td></tr>
<tr class="separator:a65f4c637d8673d733619c36e5218c731"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f03caf15dc8b85bb58577a9b4fa135c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a3f03caf15dc8b85bb58577a9b4fa135c"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SIN</b>(<a class="el" href="structaddr.html">addr</a>)&#160;&#160;&#160;((struct sockaddr_in *)(<a class="el" href="structaddr.html">addr</a>))</td></tr>
<tr class="separator:a3f03caf15dc8b85bb58577a9b4fa135c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2210a7642c447b7ae96bd7c63636494f"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a2210a7642c447b7ae96bd7c63636494f"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SIN6</b>(<a class="el" href="structaddr.html">addr</a>)&#160;&#160;&#160;((struct <a class="el" href="structsockaddr__in6.html">sockaddr_in6</a> *)(<a class="el" href="structaddr.html">addr</a>))</td></tr>
<tr class="separator:a2210a7642c447b7ae96bd7c63636494f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae89fd85067fb377dad9d65c4fa27bcc4"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae89fd85067fb377dad9d65c4fa27bcc4"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>SLOCAL</b>(<a class="el" href="structaddr.html">addr</a>)&#160;&#160;&#160;((struct sockaddr_un *)(<a class="el" href="structaddr.html">addr</a>))</td></tr>
<tr class="separator:ae89fd85067fb377dad9d65c4fa27bcc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a783a541cc86a1a16ff85d91c812c92bb"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a783a541cc86a1a16ff85d91c812c92bb"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>FOUND_IPV4</b>&#160;&#160;&#160;0x1</td></tr>
<tr class="separator:a783a541cc86a1a16ff85d91c812c92bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae01fdff7f765c1e5d429483974c946ad"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="ae01fdff7f765c1e5d429483974c946ad"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>FOUND_IPV6</b>&#160;&#160;&#160;0x2</td></tr>
<tr class="separator:ae01fdff7f765c1e5d429483974c946ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c2590b9ff5b3c5e69283300a0bb990a"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a8c2590b9ff5b3c5e69283300a0bb990a"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>FOUND_MAX</b>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a8c2590b9ff5b3c5e69283300a0bb990a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c10ae46162a8d3f4d961ee7eb34d463"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a7c10ae46162a8d3f4d961ee7eb34d463"></a>
#define&#160;</td><td class="memItemRight" valign="bottom"><b>ISC_AI_MASK</b>&#160;&#160;&#160;(AI_PASSIVE|AI_CANONNAME|AI_NUMERICHOST)</td></tr>
<tr class="separator:a7c10ae46162a8d3f4d961ee7eb34d463"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9a271b3b96cf769ac292c0165f86e13"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><b>SETERROR</b>(code)</td></tr>
<tr class="separator:ac9a271b3b96cf769ac292c0165f86e13"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a36a5b3dbddc8fb797f9ec1a1fcdb08c6"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a36a5b3dbddc8fb797f9ec1a1fcdb08c6"></a>
static struct <a class="el" href="structaddrinfo.html">addrinfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><b>ai_clone</b> (struct <a class="el" href="structaddrinfo.html">addrinfo</a> *oai, int family)</td></tr>
<tr class="separator:a36a5b3dbddc8fb797f9ec1a1fcdb08c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a51667c7d617ea73728e3f3da0eaa2ba3"><td class="memItemLeft" align="right" valign="top">static struct <a class="el" href="structaddrinfo.html">addrinfo</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="lib_2lwres_2getaddrinfo_8c.html#a51667c7d617ea73728e3f3da0eaa2ba3">ai_alloc</a> (int family, int addrlen)</td></tr>
<tr class="separator:a51667c7d617ea73728e3f3da0eaa2ba3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22aebd28e258514af4f5ae9fcc3be93c"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="a22aebd28e258514af4f5ae9fcc3be93c"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>lwres_getaddrinfo</b> (const char *hostname, const char *servname, const struct <a class="el" href="structaddrinfo.html">addrinfo</a> *hints, struct <a class="el" href="structaddrinfo.html">addrinfo</a> **res)</td></tr>
<tr class="separator:a22aebd28e258514af4f5ae9fcc3be93c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec5630ae654e74e20b692356b3f1c98b"><td class="memItemLeft" align="right" valign="top"><a class="anchor" id="aec5630ae654e74e20b692356b3f1c98b"></a>
void&#160;</td><td class="memItemRight" valign="bottom"><b>lwres_freeaddrinfo</b> (struct <a class="el" href="structaddrinfo.html">addrinfo</a> *ai)</td></tr>
<tr class="separator:aec5630ae654e74e20b692356b3f1c98b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a class="anchor" id="a65f4c637d8673d733619c36e5218c731"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SA</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><a class="el" href="structaddr.html">addr</a></td><td>)</td>
          <td>&#160;&#160;&#160;((struct sockaddr *)(<a class="el" href="structaddr.html">addr</a>))</td>
        </tr>
      </table>
</div><div class="memdoc">
<p>lwres_getaddrinfo() is used to get a list of IP addresses and port numbers for host hostname and service servname. The function is the lightweight resolver's implementation of getaddrinfo() as defined in RFC2133. hostname and servname are pointers to null-terminated strings or NULL. hostname is either a host name or a numeric host address string: a dotted decimal IPv4 address or an IPv6 address. servname is either a decimal port number or a service name as listed in /etc/services.</p>
<p>If the operating system does not provide a struct addrinfo, the following structure is used:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;struct  addrinfo {</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;        int             ai_flags;       // AI_PASSIVE, AI_CANONNAME</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;        int             ai_family;      // PF_xxx</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;        int             ai_socktype;    // SOCK_xxx</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;        int             ai_protocol;    // 0 or IPPROTO_xxx for IPv4 and IPv6</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        size_t          ai_addrlen;     // length of ai_addr</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;        char            *ai_canonname;  // canonical name for hostname</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        struct sockaddr *ai_addr;       // binary address</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        struct addrinfo *ai_next;       // next structure in linked list</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;};</div></div><!-- fragment --><p>hints is an optional pointer to a struct addrinfo. This structure can be used to provide hints concerning the type of socket that the caller supports or wishes to use. The caller can supply the following structure elements in *hints:</p>
<ul>
<li>
<p class="startli">ai_family: The protocol family that should be used. When ai_family is set to PF_UNSPEC, it means the caller will accept any protocol family supported by the operating system.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">ai_socktype: denotes the type of socket &ndash; SOCK_STREAM, SOCK_DGRAM or SOCK_RAW &ndash; that is wanted. When ai_socktype is zero the caller will accept any socket type.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">ai_protocol: indicates which transport protocol is wanted: IPPROTO_UDP or IPPROTO_TCP. If ai_protocol is zero the caller will accept any protocol.</p>
<p class="endli"></p>
</li>
<li>
<p class="startli">ai_flags: Flag bits. If the AI_CANONNAME bit is set, a successful call to lwres_getaddrinfo() will return a null-terminated string containing the canonical name of the specified hostname in ai_canonname of the first addrinfo structure returned. Setting the AI_PASSIVE bit indicates that the returned socket address structure is intended for used in a call to bind(2). In this case, if the hostname argument is a NULL pointer, then the IP address portion of the socket address structure will be set to INADDR_ANY for an IPv4 address or IN6ADDR_ANY_INIT for an IPv6 address.<br />
<br />
</p>
<p>When ai_flags does not set the AI_PASSIVE bit, the returned socket address structure will be ready for use in a call to connect(2) for a connection-oriented protocol or connect(2), sendto(2), or sendmsg(2) if a connectionless protocol was chosen. The IP address portion of the socket address structure will be set to the loopback address if hostname is a NULL pointer and AI_PASSIVE is not set in ai_flags.<br />
<br />
</p>
<p class="endli">If ai_flags is set to AI_NUMERICHOST it indicates that hostname should be treated as a numeric string defining an IPv4 or IPv6 address and no name resolution should be attempted. </p>
</li>
</ul>
<p>All other elements of the struct addrinfo passed via hints must be zero.</p>
<p>A hints of NULL is treated as if the caller provided a struct addrinfo initialized to zero with ai_familyset to PF_UNSPEC.</p>
<p>After a successful call to lwres_getaddrinfo(), *res is a pointer to a linked list of one or more addrinfo structures. Each struct addrinfo in this list cn be processed by following the ai_next pointer, until a NULL pointer is encountered. The three members ai_family, ai_socktype, and ai_protocol in each returned addrinfo structure contain the corresponding arguments for a call to socket(2). For each addrinfo structure in the list, the ai_addr member points to a filled-in socket address structure of length ai_addrlen.</p>
<p>All of the information returned by lwres_getaddrinfo() is dynamically allocated: the addrinfo structures, and the socket address structures and canonical host name strings pointed to by the addrinfostructures. Memory allocated for the dynamically allocated structures created by a successful call to lwres_getaddrinfo() is released by lwres_freeaddrinfo(). ai is a pointer to a struct addrinfo created by a call to lwres_getaddrinfo().</p>
<h1><a class="anchor" id="lwresreturn"></a>
RETURN VALUES</h1>
<p>lwres_getaddrinfo() returns zero on success or one of the error codes listed in gai_strerror() if an error occurs. If both hostname and servname are NULL lwres_getaddrinfo() returns #EAI_NONAME.</p>
<h1><a class="anchor" id="lwressee"></a>
SEE ALSO</h1>
<p>lwres(3), lwres_getaddrinfo(), lwres_freeaddrinfo(), lwres_gai_strerror(), RFC2133, getservbyname(3), connect(2), sendto(2), sendmsg(2), socket(2). </p>

</div>
</div>
<a class="anchor" id="ac9a271b3b96cf769ac292c0165f86e13"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SETERROR</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">code</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line"><span class="keywordflow">do</span> { result = (code);           \</div><div class="line">        if (result != 0) goto cleanup;  \</div><div class="line">    } while (0)</div></div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a51667c7d617ea73728e3f3da0eaa2ba3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">static struct <a class="el" href="structaddrinfo.html">addrinfo</a> * ai_alloc </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>family</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>addrlen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Allocate an addrinfo structure, and a sockaddr structure of the specificed length. We initialize: ai_addrlen ai_family ai_addr ai_addr-&gt;sa_family ai_addr-&gt;sa_len (LWRES_PLATFORM_HAVESALEN) and everything else is initialized to zero. </p>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
